<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Ad Block Detection</title>
    <style>
        #ad-test-banner {
            height: 1px;
            width: 1px;
            position: absolute;
            left: -9999px;
            top: -9999px;
        }
    </style>
</head>
<body>
    <h1>Ad Block Detection Test</h1>
    <div id="status">Running checks...</div>

    <!-- Test elements -->
    <div id="ad-test-banner" class="ad ads ad-banner"></div>
    <ins class="adsbygoogle" style="display: none;"></ins>

    <script>
        (async function() {
            // Method 1: Element visibility check
            function checkElementVisibility() {
                const testElement = document.getElementById('ad-test-banner');
                return testElement ? 
                    (testElement.offsetHeight === 0 || 
                     window.getComputedStyle(testElement).display === 'none') : 
                    true;
            }

            // Method 2: Fake ad request test
            async function checkAdRequest() {
                try {
                    const response = await fetch('https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js');
                    return false; // Not blocked
                } catch {
                    return true; // Blocked
                }
            }

            // Method 3: Script injection test
            function checkScriptInjection() {
                const script = document.createElement('script');
                script.src = 'https://adservice.google.com/adsid/integrator.js';
                document.body.appendChild(script);
                return new Promise(resolve => {
                    script.onload = () => resolve(false);
                    script.onerror = () => resolve(true);
                });
            }

            // Method 4: AdBlocker namespace check
            function checkGlobalNamespace() {
                try {
                    if(window.adblock || window.adsbygoogle === undefined) {
                        return true;
                    }
                    return false;
                } catch {
                    return true;
                }
            }

            async function runDetection() {
                const results = await Promise.all([
                    checkElementVisibility(),
                    checkAdRequest(),
                    checkScriptInjection(),
                    checkGlobalNamespace()
                ]);

                return results.some(result => result === true);
            }

            function displayResult(isBlocked) {
                const status = document.getElementById('status');
                status.textContent = isBlocked ? 
                    'Ad blocker detected! ðŸ›‘' : 
                    'No ad blocker detected âœ…';
                status.style.color = isBlocked ? '#e74c3c' : '#27ae60';
                status.style.fontWeight = 'bold';
                status.style.padding = '15px';
                status.style.marginTop = '20px';
            }

            // Run detection after delay
            setTimeout(async () => {
                try {
                    const isBlocked = await runDetection();
                    displayResult(isBlocked);
                } catch (error) {
                    console.error('Detection error:', error);
                }
            }, 2000);
        })();
    </script>
</body>
</html>
